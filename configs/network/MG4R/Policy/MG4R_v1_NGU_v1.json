{ "NetworkName" : "MG4R_NGU",
  "NetworkBuilder":"network",
  "DefaultParams":{ "SFSize":256,
                    "FCUnits":256},
  "Inputs":{"state":[19,19,2]},
  "NetworkStructure":{
    "Phi":[
      { "layerType":"BasicCNNSplit",
        "layerName":"InputSplit",
        "layerInput":"input.state",
        "multiOutput":["in_background","in_agent"],
        "Parameters":{"division":1}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_1",
        "layerInput":"in_background",
        "Parameters":{"filters":32,
                      "kernel_size":6,
                      "strides":2,
                      "padding":"same",
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_2",
        "layerInput":"Conv2D_1",
        "Parameters":{"filters":64,
                      "kernel_size":4,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_3",
        "layerInput":"Conv2D_2",
        "Parameters":{"filters":128,
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Flatten",
        "layerName":"Flatten",
        "layerInput":"Conv2D_3"},

      { "layerType":"Conv2D",
        "layerName":"Conv2D_1_agent",
        "layerInput":"in_agent",
        "Parameters":{"filters":32,
                      "kernel_size":6,
                      "strides":2,
                      "padding":"same",
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_2_agent",
        "layerInput":"Conv2D_1_agent",
        "Parameters":{"filters":64,
                      "kernel_size":4,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_3_agent",
        "layerInput":"Conv2D_2_agent",
        "Parameters":{"filters":128,
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Flatten",
        "layerName":"Flatten_agent",
        "layerInput":"Conv2D_3_agent"},

      { "layerType":"Concatenate",
        "layerName":"Concatenate_phi",
        "layerInput":["Flatten","Flatten_agent"],
        "Parameters":{}},

      { "layerType":"Dense",
        "layerName":"Dense1",
        "layerInput":"Concatenate_phi",
        "Parameters":{"units":256,
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"Phi",
        "layerInput":"Dense1",
        "Parameters":{"units":256,
                      "activation":null}}
      ],

    "EmbeddingS":[
      { "layerType":"Conv2D",
        "layerName":"Conv2D_Embedding_1",
        "layerInput":"input.state",
        "Parameters":{"filters":32,
                      "kernel_size":6,
                      "strides":2,
                      "padding":"same",
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_Embedding_2",
        "layerInput":"Conv2D_Embedding_1",
        "Parameters":{"filters":64,
                      "kernel_size":4,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_Embedding_3",
        "layerInput":"Conv2D_Embedding_2",
        "Parameters":{"filters":128,
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Flatten",
        "layerName":"Flatten_Embedding",
        "layerInput":"Conv2D_Embedding_3"},

      { "layerType":"Dense",
        "layerName":"Phi_s",
        "layerInput":"Flatten_Embedding",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}}
      ],

    "EmbeddingSNext":[
      { "layerType":"Conv2D",
        "layerName":"Conv2D_Embedding_1_",
        "layerInput":"input.state",
        "ReuseLayer":"Conv2D_Embedding_1"},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_Embedding_2_",
        "layerInput":"Conv2D_Embedding_1_",
        "ReuseLayer":"Conv2D_Embedding_2"},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_Embedding_3_",
        "layerInput":"Conv2D_Embedding_2_",
        "ReuseLayer":"Conv2D_Embedding_3"},
      { "layerType":"Flatten",
        "layerName":"Flatten_Embedding_",
        "layerInput":"Conv2D_Embedding_3_",
        "ReuseLayer":"Flatten_Embedding"},

      { "layerType":"Dense",
        "layerName":"Phi_s_",
        "layerInput":"Flatten_Embedding_",
        "ReuseLayer":"Phi_s"}
      ],

    "ActionPrediction":[
      { "layerType":"Concatenate",
        "layerName":"Concatenate",
        "layerInput":["Phi_s","Phi_s_"],
        "Parameters":{}},
      { "layerType":"Dense",
        "layerName":"AP1",
        "layerInput":"Concatenate",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"AP2",
        "layerInput":"AP1",
        "Parameters":{"units":"actionSize",
                      "activation":null}}
    ],

    "RND_Random_Net":[
      { "layerType":"Conv2D",
        "layerName":"Conv2D_RND_1",
        "layerInput":"input.state",
        "Parameters":{"filters":32,
                      "trainable":false,
                      "kernel_size":6,
                      "strides":2,
                      "padding":"same",
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_RND_2",
        "layerInput":"Conv2D_RND_1",
        "Parameters":{"filters":64,
                      "trainable":false,
                      "kernel_size":4,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_RND_3",
        "layerInput":"Conv2D_RND_2",
        "Parameters":{"filters":128,
                      "trainable":false,
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Flatten",
        "layerName":"Flatten_RND",
        "layerInput":"Conv2D_RND_3"},

      { "layerType":"Dense",
        "layerName":"RND_Phi",
        "layerInput":"Flatten_RND",
        "Parameters":{"units":"FCUnits",
                      "trainable":false,
                      "activation":null}}
    ],

    "RND_Predict_Net":[
      { "layerType":"Conv2D",
        "layerName":"Conv2D_RNDP_1",
        "layerInput":"input.state",
        "Parameters":{"filters":32,
                      "kernel_size":6,
                      "strides":2,
                      "padding":"same",
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_RNDP_2",
        "layerInput":"Conv2D_RNDP_1",
        "Parameters":{"filters":64,
                      "kernel_size":4,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_RNDP_3",
        "layerInput":"Conv2D_RNDP_2",
        "Parameters":{"filters":128,
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Flatten",
        "layerName":"Flatten_RNDP",
        "layerInput":"Conv2D_RNDP_3"},

      { "layerType":"Dense",
        "layerName":"RNDP_Phi",
        "layerInput":"Flatten_RNDP",
        "Parameters":{"units":"FCUnits",
                      "activation":null}}
    ],

    "Q":[
      { "layerType":"Dense",
        "layerName":"Critic_FC1",
        "layerInput":"Phi",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"Critic_FC2",
        "layerInput":"Critic_FC1",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"Critic_FC3",
        "layerInput":"Critic_FC2",
        "Parameters":{"units":"actionSize",
                      "activation":null}},
      { "layerType":"StopNan",
        "layerName":"StopNan",
        "layerInput":"Critic_FC3"}
    ]
  },

  "NetworkOutputs":
    {
      "latent_space":"Phi",
      "Q":"Critic_FC3",
      "action_prediction":"AP2",
      "RND_predictor":"RND_Phi",
      "RND_random":"RNDP_Phi"
    },

  "NetworkVariableGroups":{
    "Critic":["Phi","Q"],
    "Intrinsic":["EmbeddingS","EmbeddingSNext","ActionPrediction","RND_Predict_Net"]
  },
  "TestInput":{"state":[null,7,7,4]}

  }
