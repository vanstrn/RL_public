{ "NetworkName" : "MG_SF",
  "NetworkBuilder":"network",
  "DefaultParams":{ "SFSize":256,
                    "InFilter":128,
                    "FCUnits":256},
  "Inputs":{"state":[19,19,2]},
  "NetworkStructure":{
    "EmbeddingS":[
      { "layerType":"Conv2D",
        "layerName":"Conv2D_1",
        "layerInput":"input.state",
        "Parameters":{"filters":"InFilter//4",
                      "kernel_size":4,
                      "strides":1,
                      "activation":"relu"}},

      { "layerType":"Conv2D",
        "layerName":"Conv2D_2",
        "layerInput":"Conv2D_1",
        "Parameters":{"filters":"InFilter//2",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_3",
        "layerInput":"Conv2D_2",
        "Parameters":{"filters":"InFilter",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_4",
        "layerInput":"Conv2D_3",
        "Parameters":{"filters":"InFilter",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Flatten",
        "layerName":"Flatten",
        "layerInput":"Conv2D_4"},
      { "layerType":"Dense",
        "layerName":"Dense1",
        "layerInput":"Flatten",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"Phi",
        "layerInput":"Dense1",
        "Parameters":{"units":"SFSize",
                      "activation":"relu"}}
      ],
    "EmbeddingSNext":[
      { "layerType":"Conv2D",
        "layerName":"Conv2D_1_",
        "layerInput":"input.state_next",
        "ReuseLayer":"Conv2D_1"},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_2_",
        "layerInput":"Conv2D_1_",
        "ReuseLayer":"Conv2D_2"},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_3_",
        "layerInput":"Conv2D_2_",
        "ReuseLayer":"Conv2D_3"},
      { "layerType":"Conv2D",
        "layerName":"Conv2D_4_",
        "layerInput":"Conv2D_3_",
        "ReuseLayer":"Conv2D_4"},
      { "layerType":"Flatten",
        "layerName":"Flatten_",
        "layerInput":"Conv2D_4_",
        "ReuseLayer":"Flatten"},
      { "layerType":"Dense",
        "layerName":"Dense1_",
        "layerInput":"Flatten_",
        "ReuseLayer":"Dense1"},
      { "layerType":"Dense",
        "layerName":"Phi_",
        "layerInput":"Dense1_",
        "ReuseLayer":"Phi"}
      ],

    "ActionPrediction":[
      { "layerType":"Concatenate",
        "layerName":"Concatenate",
        "layerInput":["Phi","Phi_"],
        "Parameters":{}},
      { "layerType":"Dense",
        "layerName":"AP1",
        "layerInput":"Concatenate",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"AP2",
        "layerInput":"AP1",
        "Parameters":{"units":"actionSize",
                      "activation":"relu"}}
    ],

    "RND_Random_Net":[
      { "layerType":"Conv2D",
        "layerName":"RND_Conv2D_1",
        "layerInput":"input.state",
        "Parameters":{"filters":"InFilter//4",
                      "kernel_size":4,
                      "strides":1,
                      "activation":"relu",
                      "trainable":false}},

      { "layerType":"Conv2D",
        "layerName":"RND_Conv2D_2",
        "layerInput":"RND_Conv2D_1",
        "Parameters":{"filters":"InFilter//2",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu",
                      "trainable":false}},
      { "layerType":"Conv2D",
        "layerName":"RND_Conv2D_3",
        "layerInput":"RND_Conv2D_2",
        "Parameters":{"filters":"InFilter",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu",
                      "trainable":false}},
      { "layerType":"Conv2D",
        "layerName":"RND_Conv2D_4",
        "layerInput":"RND_Conv2D_3",
        "Parameters":{"filters":"InFilter",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu",
                      "trainable":false}},
      { "layerType":"Flatten",
        "layerName":"RND_Flatten",
        "layerInput":"RND_Conv2D_4"},
      { "layerType":"Dense",
        "layerName":"RND_Dense1",
        "layerInput":"RND_Flatten",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu",
                      "trainable":false}},
      { "layerType":"Dense",
        "layerName":"RND_Phi",
        "layerInput":"RND_Dense1",
        "Parameters":{"units":"SFSize",
                      "activation":"relu",
                      "trainable":false}}
    ],

    "RND_Predict_Net":[
      { "layerType":"Conv2D",
        "layerName":"RNDP_Conv2D_1",
        "layerInput":"input.state",
        "Parameters":{"filters":"InFilter//4",
                      "kernel_size":4,
                      "strides":1,
                      "activation":"relu"}},

      { "layerType":"Conv2D",
        "layerName":"RNDP_Conv2D_2",
        "layerInput":"RNDP_Conv2D_1",
        "Parameters":{"filters":"InFilter//2",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"RNDP_Conv2D_3",
        "layerInput":"RNDP_Conv2D_2",
        "Parameters":{"filters":"InFilter",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Conv2D",
        "layerName":"RNDP_Conv2D_4",
        "layerInput":"RNDP_Conv2D_3",
        "Parameters":{"filters":"InFilter",
                      "kernel_size":3,
                      "strides":1,
                      "activation":"relu"}},
      { "layerType":"Flatten",
        "layerName":"RNDP_Flatten",
        "layerInput":"RNDP_Conv2D_4"},
      { "layerType":"Dense",
        "layerName":"RNDP_Dense1",
        "layerInput":"RNDP_Flatten",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"RNDP_Phi",
        "layerInput":"RNDP_Dense1",
        "Parameters":{"units":"SFSize",
                      "activation":"relu"}}
    ],

    "Qe":[
      { "layerType":"Dense",
        "layerName":"ECritic_FC1",
        "layerInput":"Phi",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"ECritic_FC2",
        "layerInput":"ECritic_FC1",
        "Parameters":{"units":"FCUnits",
                      "activation":"relu"}},
      { "layerType":"Dense",
        "layerName":"ECritic_FC3",
        "layerInput":"ECritic_FC2",
        "Parameters":{"units":"actionSize",
                      "activation":null}}
    ],

  "Qi":[
    { "layerType":"Dense",
      "layerName":"ICritic_FC1",
      "layerInput":"Phi",
      "Parameters":{"units":"FCUnits",
                    "activation":"relu"}},
    { "layerType":"Dense",
      "layerName":"ICritic_FC2",
      "layerInput":"ICritic_FC1",
      "Parameters":{"units":"FCUnits",
                    "activation":"relu"}},
    { "layerType":"Dense",
      "layerName":"ICritic_FC3",
      "layerInput":"ICritic_FC2",
      "Parameters":{"units":"actionSize",
                    "activation":null}}
  ],
  "Q_Combine":[
    { "layerType":"Multiply",
      "layerName":"Critic_Multiply",
      "layerInput":["input.beta","ICritic_FC3"],
      "Parameters":{}},
    { "layerType":"Add",
      "layerName":"Critic_Add",
      "layerInput":["Critic_Multiply","ECritic_FC3"],
      "Parameters":{}}
  ]
},

  "NetworkOutputs":
    {
      "latent_space":"Phi",
      "Q":"Critic_Add",
      "action_prediction":"AP2",
      "RND_predictor":"RND_Phi",
      "RND_random":"RNDP_Phi"
    },

  "NetworkVariableGroups":{
    "Critic":["Shared","Q"]
  },
  "TestInput":{"state":[null,7,7,4]}

  }
